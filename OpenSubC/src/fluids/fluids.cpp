#include "fluids.h"
#include<cmath>

double opensubc::CO2::h(double p, double t) {
    double a[5] = { -1.42101,8.72986,-19.462,11.08749,-0.97826 };
    double b[5] = { 9.67303,-48.26339,104.01501,-59.74097,5.57283 };
    double c[5] = { -18.02611,97.33641,-206.0090,119.21196,-11.64132 };
    double d[5] = { 15.97775,-85.65223,179.22737,-104.40354,10.5892 };
    double e[5] = { -5.19521,27.8447,-57.80601,33.86865,-3.54565 };
    double z, x, y;
    //DataElement temp;
    x = t / 780; y = p / 20; z = 0;
    for (int i = 0; i < 5; i++) {
        z += (a[i] + b[i] * x + c[i] * x * x + d[i] * x * x * x + e[i] * x * x * x * x) * pow(y, i);
    }
    z *= 990;
    return z;
}

double opensubc::CO2::t(double p, double h) {
    double a[5] = { -0.87811,4.19127,1.11324,-6.78545,3.22732 };
    double b[5] = { 3.58799,-15.32662,-14.17288,41.41008,-18.53626 };
    double c[5] = { -2.79791,19.82254,41.9763,-91.03666,38.97091 };
    double d[5] = { 1.14141,-9.87656,-47.0195,86.16367,-35.64303 };
    double e[5] = { -0.06412,1.20086,18.13742,-29.79073,11.99363 };
    double z, x, y;
    x = h / 990; y = p / 20; z = 0;
    for (int i = 0; i < 5; i++) {
        z += (a[i] + b[i] * x + c[i] * x * x + d[i] * x * x * x + e[i] * x * x * x * x) * pow(y, i);
    }
    z *= 780;
    return z;
}

double opensubc::CO2::rho(double p, double h) {
    double a[6] = { 5.51141,-31.90696,116.86343,-84.53118,-26.86934,29.46078 };
    double b[6] = { -30.68877,177.99507,-597.69806,275.28642,388.4933,-254.14657 };
    double c[6] = { 66.27682,-367.93354,1138.11163,-24.97488,-1538.7021,812.59139 };
    double d[6] = { -69.14811,351.83442,-963.95423,-807.41087,2628.70703,-1232.66205 };
    double e[6] = { 34.62849,-149.98417,317.08842,1018.0708,-2067.58415,899.00831 };
    double f[6] = { -6.57949,20.26986,-10.35475,-376.60235,616.10422,-254.29788 };
    double z, x, y;
    x = h / 990; y = p / 20; z = 0;
    for (int i = 0; i < 6; i++) {
        z += (a[i] + b[i] * x + c[i] * x * x + d[i] * x * x * x + e[i] * x * x * x * x + f[i] * x * x * x * x * x) * pow(y, i);
    }
    z *= 480;
    return z;
}

double opensubc::CO2::u(double rho, double t) {
    double a[4] = { -0.07622,1.34854,-0.54067,0.12929 };
    double b[4] = { 0.23975,-0.6812,0.81125,-0.32631 };
    double c[4] = { 0.04682,1.31995,-1.62115,0.69507 };
    double d[4] = { 0.287,-1.11705,1.53517,-0.74812 };
    double z, x, y;
    x = rho / 480; y = t / 780; z = 0;
    for (int i = 0; i < 4; i++) {
        z += (a[i] + b[i] * x + c[i] * x * x + d[i] * x * x * x) * pow(y, i);
    }
    z *= 40;
    return z;
}

double opensubc::CO2::k(double rho, double t)
{
    double a[5] = { 1.73319,-12.30436,33.86575,-35.65537,13.23967 };
    double b[5] = { -36.88377,241.2076,-565.82226,562.2425,-199.52577 };
    double c[5] = { 202.2069,-1256.10471,2821.67532,-2684.92673,908.88515 };
    double d[5] = { -354.37541,2134.20547,-4583.30612,4089.1985,-1255.87906 };
    double e[5] = { 156.08372,-845.03747,1513.56125,-928.21944,66.71366 };
    double z, x, y;

    x = rho / 480; y = t / 780; z = 0;
    for (int i = 0; i < 5; i++) {
        z += (a[i] + b[i] * x + c[i] * x * x + d[i] * x * x * x + e[i] * x * x * x * x) * pow(y, i);
    }
    z *= 60;
    return z;
}


double opensubc::CO2::cp(double h, double p)
{
    double a[6] = { 78.2616,-505.96403,1283.184,-1047.6003,-8.71962,209.14598 };
    double b[6] = { -442.48715,2776.18208,-6556.89741,3839.11215,2422.70087,-2075.59975 };
    double c[6] = { 966.46759,-5761.21712,12144.03687,-2038.16407,-12470.4431,7226.02384 };
    double d[6] = { -1004.9428,5524.98006,-9327.54913,-7565.71111,23962.9249,-11644.52629 };
    double e[6] = { 488.94838,-2319.84029,1960.7882,11258.1662,-20272.26838,8902.51944 };
    double f[6] = { -85.68895,285.24633,498.64679,-4449.55008,6368.83762,-2618.48425 };
    double z, x, y;

    x = h / 990; y = p / 20; z = 0;
    for (int i = 0; i < 6; i++) {
        z += (a[i] + b[i] * x + c[i] * x * x + d[i] * x * x * x + e[i] * x * x * x * x + f[i] * x * x * x * x * x) * pow(y, i);
    }
    z *= 2.4;
    return z;
}